# V5.2 部署注意事項

## ⚠️ 重要：必須刪除舊資料庫

### 問題說明

V5.2 修正了 MOMO spec_name 格式，但如果使用舊的 `inventory.db`，裡面的資料仍然是舊格式：

**舊資料（V5.1 及之前）**：
- Yahoo spec: `/44`
- MOMO spec: `44` ← 沒有斜線

**新資料（V5.2）**：
- Yahoo spec: `/44`
- MOMO spec: `/44` ← 統一格式

### 部署步驟

#### 1. 在白名單電腦上刪除舊資料庫
```
刪除檔案：inventory.db
```

#### 2. 複製新版本
```
複製整個 dist/InventorySync_V5/ 資料夾
```

#### 3. 執行同步
```
執行 InventorySync_V5.exe
```

程式會：
1. 自動建立新的 inventory.db
2. 重新下載三平台資料
3. 使用新格式儲存（MOMO spec 會有 `/` 前綴）
4. 正確比對 Yahoo 和 MOMO

### 預期結果

**Stock_Comparison 應該顯示**：
```
SKU          | Spec | Yahoo Qty | MOMO Qty | Status
-------------|------|-----------|----------|--------
1810317-34   | /44  | 1         | 1        | 一致
1810317-34   | /46  | 1         | 1        | 一致
```

**不應該出現**：
```
1810317-34   | /44  | 1         | 0        | ← 錯誤
1810317-34   | /46  | 0         | 1        | ← 錯誤
```

### 驗證方式

#### 1. 檢查 MOMO_Inventory 工作表
確認 Spec 欄位有 `/` 前綴：
```
SKU          | Spec
-------------|------
1810317-34   | /44   ← 應該有斜線
1810317-34   | /46   ← 應該有斜線
```

#### 2. 檢查 Stock_Comparison 工作表
確認相同 Part No + Spec 的記錄只有一筆，且兩邊數量都正確。

### 如果還是有問題

請提供：
1. 新的 `Inventory_Sync_Log.xlsx`
2. 新的 `sync_v5.log`
3. MOMO_Inventory 工作表的 Spec 欄位截圖

---

**重點**：一定要刪除舊的 `inventory.db`，讓程式重新建立！
