# V4.5 版本打包說明

## 版本資訊
- **版本號**: V4.5
- **發布日期**: 2025-12-02
- **打包目的**: 測試版本

## 新增功能

### Yahoo 過期產品過濾
- 自動過濾已過期的 Yahoo 商品 (基於 endTs 時間戳)
- 新增工具腳本:
  - `filter_expired_yahoo_products.py` - 過期產品過濾工具
  - `yahoo_product_inspector.py` - 產品檢查工具
  - `yahoo_product_inspector_enhanced.py` - 增強版檢查工具
- 改善資料品質:僅同步有效期內的商品

### 優化項目
- 改善 Yahoo API 資料處理邏輯
- 新增詳細文件說明

## 打包方法

### 方法一:使用自動化腳本 (推薦)
```batch
build_v4.5.bat
```

### 方法二:手動打包
```batch
# 1. 安裝依賴 (如果尚未安裝)
pip install -r requirements.txt

# 2. 執行打包
pyinstaller InventorySync.spec --clean
```

## 打包內容

### 包含的檔案
- ✅ 所有 Python 源碼 (src 資料夾)
- ✅ config 資料夾 (包含配置檔案範本)
- ✅ size.xlsx (規格尺寸對照表)
- ✅ 所有必要的 Python 套件

### 輸出位置
```
dist/InventorySync/
├── InventorySync.exe    # 主執行檔
├── config/              # 配置資料夾
│   ├── credentials_template.json
│   └── google_credentials.json
├── size.xlsx            # 尺寸對照表
├── VERSION.txt          # 版本資訊
└── [其他依賴檔案]
```

## 部署前檢查清單

- [ ] 確認 `config/credentials.json` 已正確配置
  - Yahoo API 金鑰
  - PChome API 金鑰
  - MOMO API 金鑰
  - Google Sheets 憑證
  
- [ ] 確認 `size.xlsx` 檔案存在且內容正確

- [ ] 確認 `config/google_credentials.json` 已正確配置

## 測試步驟

### 1. 基本功能測試
```batch
cd dist\InventorySync
InventorySync.exe
```

### 2. 檢查日誌
- 查看 `sync.log` 檔案
- 確認沒有錯誤訊息
- 驗證 Yahoo 過期產品已被正確過濾

### 3. 驗證資料
- 檢查 Google Sheets 是否正確更新
- 確認只包含有效期內的 Yahoo 商品
- 驗證規格欄位是否正確填入

### 4. 效能測試
- 記錄同步時間
- 檢查記憶體使用量
- 驗證 API 呼叫次數

## 已知問題

目前無已知問題。

## 回報問題

如果在測試過程中發現問題,請記錄:
1. 錯誤訊息 (來自 sync.log)
2. 執行環境 (Windows 版本)
3. 重現步驟
4. 預期行為 vs 實際行為

## 下一步計劃

測試通過後,將進行:
- V5.0 版本開發 (Google Sheets 架構優化)
- 更多平台整合
- UI 介面開發
