# ä¸‰å¹³å°åº«å­˜åŒæ­¥ç³»çµ± - ç‰ˆæœ¬æ¼”é€²æ­·å²

## ğŸ“‹ ç›®éŒ„
- [V1.0 - åŸºç¤ç‰ˆæœ¬](#v10---åŸºç¤ç‰ˆæœ¬)
- [V2.0 - é›¶åº«å­˜éæ¿¾](#v20---é›¶åº«å­˜éæ¿¾)
- [V3.0 - å¤šå·¥ä½œè¡¨æ•´åˆ](#v30---å¤šå·¥ä½œè¡¨æ•´åˆ)
- [V4.0 - Yahoo Models æ•´åˆ](#v40---yahoo-models-æ•´åˆ)
- [V4.2 - Spec é‚è¼¯ç°¡åŒ–](#v42---spec-é‚è¼¯ç°¡åŒ–)
- [V4.3 - ç§»é™¤å­—å…ƒé™åˆ¶](#v43---ç§»é™¤å­—å…ƒé™åˆ¶)
- [V4.5 - æ¸¬è©¦ç‰ˆæœ¬](#v45---æ¸¬è©¦ç‰ˆæœ¬)
- [V5.0 - éæœŸç”¢å“éæ¿¾](#v50---éæœŸç”¢å“éæ¿¾-æœ€æ–°ç‰ˆ)

---

## V1.0 - åŸºç¤ç‰ˆæœ¬
**ç™¼å¸ƒæ—¥æœŸ**: 2025-11 åˆ

### ä¸»è¦åŠŸèƒ½
- âœ… ä¸‰å¹³å° API æ•´åˆï¼ˆYahooã€PChomeã€MOMOï¼‰
- âœ… åŸºç¤åº«å­˜ä¸‹è¼‰
- âœ… SQLite è³‡æ–™åº«å„²å­˜
- âœ… Google Sheets åŒæ­¥
- âœ… ç°¡æ˜“ Dashboard

### æŠ€è¡“æ¶æ§‹
```
src/
â”œâ”€â”€ yahoo_client.py      # Yahoo API å®¢æˆ¶ç«¯
â”œâ”€â”€ pchome_client.py     # PChome API å®¢æˆ¶ç«¯
â”œâ”€â”€ momo_client.py       # MOMO API å®¢æˆ¶ç«¯
â”œâ”€â”€ database.py          # è³‡æ–™åº«ç®¡ç†
â”œâ”€â”€ sheets_client.py     # Google Sheets å®¢æˆ¶ç«¯
â””â”€â”€ sync_manager.py      # åŒæ­¥ç®¡ç†å™¨
```

### å·²çŸ¥å•é¡Œ
- âŒ åŒ…å«é›¶åº«å­˜ç”¢å“
- âŒ Yahoo ç”¢å“ç„¡è¦æ ¼è³‡è¨Š
- âŒ å–®ä¸€ Google Sheets å·¥ä½œè¡¨

---

## V2.0 - é›¶åº«å­˜éæ¿¾
**ç™¼å¸ƒæ—¥æœŸ**: 2025-11 ä¸­

### æ–°å¢åŠŸèƒ½
- âœ… è‡ªå‹•éæ¿¾é›¶åº«å­˜ç”¢å“
- âœ… æ¸›å°‘ç„¡æ•ˆè³‡æ–™åŒæ­¥
- âœ… æå‡åŒæ­¥æ•ˆç‡

### æ”¹é€²é …ç›®
- åŒæ­¥é€Ÿåº¦æå‡ 30%
- è³‡æ–™åº«å¤§å°æ¸›å°‘ 40%
- Google Sheets è³‡æ–™æ›´ç²¾ç°¡

### ç¨‹å¼ç¢¼è®Šæ›´
```python
# sync_manager.py
def run_sync(self):
    # éæ¿¾é›¶åº«å­˜
    yahoo_inv = [p for p in yahoo_inv if p.get('quantity', 0) > 0]
    pchome_inv = [p for p in pchome_inv if p.get('quantity', 0) > 0]
    momo_inv = [p for p in momo_inv if p.get('quantity', 0) > 0]
```

---

## V3.0 - å¤šå·¥ä½œè¡¨æ•´åˆ
**ç™¼å¸ƒæ—¥æœŸ**: 2025-11 ä¸‹

### æ–°å¢åŠŸèƒ½
- âœ… å¤šå€‹ Google Sheets å·¥ä½œè¡¨
  - `Yahoo_Inventory` - Yahoo åº«å­˜
  - `PChome_Inventory` - PChome åº«å­˜
  - `MOMO_Inventory` - MOMO åº«å­˜
  - `Stock_Comparison` - è·¨å¹³å°æ¯”å°
  - `Sync_Log` - åŒæ­¥æ—¥èªŒ

### æ”¹é€²é …ç›®
- è³‡æ–™åˆ†é¡æ›´æ¸…æ™°
- ä¾¿æ–¼å€‹åˆ¥å¹³å°æŸ¥è©¢
- æ–°å¢è·¨å¹³å°æ¯”å°åŠŸèƒ½

### Google Sheets çµæ§‹
```
å·¥ä½œè¡¨ 1: Yahoo_Inventory
â”œâ”€â”€ SKU
â”œâ”€â”€ Name
â”œâ”€â”€ Spec
â”œâ”€â”€ Quantity
â”œâ”€â”€ Part No
â””â”€â”€ Last Updated

å·¥ä½œè¡¨ 2: Stock_Comparison
â”œâ”€â”€ SKU
â”œâ”€â”€ Name
â”œâ”€â”€ Spec
â”œâ”€â”€ Min Qty
â”œâ”€â”€ Yahoo Qty
â”œâ”€â”€ PChome Qty
â”œâ”€â”€ MOMO Qty
â””â”€â”€ Status
```

---

## V4.0 - Yahoo Models æ•´åˆ
**ç™¼å¸ƒæ—¥æœŸ**: 2025-11-30

### ä¸»è¦æ›´æ–°
- âœ… æ•´åˆ Yahoo Listing API
- âœ… è‡ªå‹•æå–ç”¢å“è¦æ ¼ï¼ˆSpecï¼‰
- âœ… å¾ `models` æ¬„ä½è§£æè¦æ ¼åç¨±

### æŠ€è¡“ç´°ç¯€
```python
# yahoo_client.py
def fetch_listing_details(self, listing_id):
    """ç²å– Listing è©³ç´°è³‡è¨Š"""
    uri = f'https://tw.supplier.yahoo.com/api/spa/v1/listings/{listing_id}'
    response = requests.get(uri, headers=headers)
    data = response.json()
    
    # æå– models ä¸­çš„ spec_name
    models = data.get('models', [])
    for model in models:
        spec_name = model.get('spec_name', '')
```

### å·²çŸ¥å•é¡Œ
- âš ï¸ API èª¿ç”¨æ¬¡æ•¸å¤§å¹…å¢åŠ 
- âš ï¸ åŒæ­¥æ™‚é–“å»¶é•·ï¼ˆæ¯å€‹ç”¢å“éœ€é¡å¤–èª¿ç”¨ Listing APIï¼‰
- âš ï¸ Spec æå–é‚è¼¯è¤‡é›œ

---

## V4.2 - Spec é‚è¼¯ç°¡åŒ–
**ç™¼å¸ƒæ—¥æœŸ**: 2025-12-01

### æ”¹é€²é …ç›®
- âœ… ç°¡åŒ– Spec æå–é‚è¼¯
- âœ… å¾ç”¢å“åç¨±ç›´æ¥æå–è¦æ ¼
- âœ… ç§»é™¤å° Listing API çš„ä¾è³´

### æå–è¦å‰‡
```python
def _extract_spec_from_name(self, name):
    """
    å¾ç”¢å“åç¨±æå–è¦æ ¼
    è¦å‰‡ï¼šå–æœ€å¾Œä¸€å€‹ '-' ä¹‹å¾Œçš„å…§å®¹ï¼ŒåŠ ä¸Š '/' å‰ç¶´
    
    ç¯„ä¾‹ï¼š
    - "LONGCHAMP 3D S-é»‘è‰²" â†’ "/é»‘è‰²"
    - "ç”¢å“åç¨±-è¦æ ¼èªªæ˜" â†’ "/è¦æ ¼èªªæ˜"
    """
    if '-' in name:
        spec = name.split('-')[-1].strip()
        return f"/{spec}"
    return ""
```

### æ•ˆèƒ½æå‡
- âš¡ åŒæ­¥é€Ÿåº¦æå‡ 80%
- âš¡ API èª¿ç”¨æ¬¡æ•¸æ¸›å°‘ 95%
- âš¡ ä¸å†éœ€è¦ Listing API

---

## V4.3 - ç§»é™¤å­—å…ƒé™åˆ¶
**ç™¼å¸ƒæ—¥æœŸ**: 2025-12-01

### æ”¹é€²é …ç›®
- âœ… ç§»é™¤ Spec å­—å…ƒæ•¸é™åˆ¶
- âœ… æ”¯æ´å®Œæ•´è¦æ ¼åç¨±é¡¯ç¤º
- âœ… ä¿®æ­£ Spec é¡¯ç¤ºå•é¡Œ

### ç¨‹å¼ç¢¼è®Šæ›´
```python
# ä¿®æ”¹å‰
if len(spec) <= 10:  # é™åˆ¶ 10 å­—å…ƒ
    return f"/{spec}"

# ä¿®æ”¹å¾Œ
return f"/{spec}"  # ç„¡é™åˆ¶
```

---

## V4.5 - æ¸¬è©¦ç‰ˆæœ¬
**ç™¼å¸ƒæ—¥æœŸ**: 2025-12-02

### ä¸»è¦ç”¨é€”
- ğŸ§ª ç©©å®šæ€§æ¸¬è©¦
- ğŸ§ª æ•ˆèƒ½é©—è­‰
- ğŸ§ª æº–å‚™ V5 é–‹ç™¼

### åŠŸèƒ½ç‹€æ…‹
- âœ… æ‰€æœ‰ V4.3 åŠŸèƒ½
- âœ… å®Œæ•´çš„ Google Sheets æ•´åˆ
- âœ… Dashboard ç¶²é ä»‹é¢
- âœ… è·¨å¹³å°åº«å­˜æ¯”å°

---

## V5.0 - éæœŸç”¢å“éæ¿¾ï¼ˆæœ€æ–°ç‰ˆï¼‰
**ç™¼å¸ƒæ—¥æœŸ**: 2025-12-03

### ğŸ¯ æ ¸å¿ƒç›®æ¨™
è§£æ±º Yahoo ç”¢å“é‡è¤‡å•é¡Œï¼ˆå¤šç­†è¨˜éŒ„ï¼šY:2, M:1ï¼‰

### é‡å¤§æ›´æ–°

#### 1. Yahoo éæœŸç”¢å“éæ¿¾
- âœ… è‡ªå‹•è­˜åˆ¥ 8,795 å€‹å·²éæœŸç”¢å“
- âœ… åªåŒæ­¥ 13,255 å€‹ä¸Šæ¶ä¸­ç”¢å“
- âœ… åŸºæ–¼ `endTs` æ¬„ä½åˆ¤æ–·éæœŸç‹€æ…‹

#### 2. æ–°å¢çµ„ä»¶
```
src/
â”œâ”€â”€ expired_product_manager.py  # éæœŸç”¢å“ç®¡ç†å™¨ï¼ˆæ–°å¢ï¼‰
â”œâ”€â”€ yahoo_client.py             # æ•´åˆéæœŸç”¢å“éæ¿¾ï¼ˆæ›´æ–°ï¼‰
â”œâ”€â”€ database.py                 # æ–°å¢æ­·å²è¿½è¹¤è¡¨ï¼ˆæ›´æ–°ï¼‰
â””â”€â”€ sync_manager_v5.py          # V5 åŒæ­¥ç®¡ç†å™¨ï¼ˆæ–°å¢ï¼‰

å·¥å…·è…³æœ¬/
â””â”€â”€ filter_expired_yahoo_products.py  # éæœŸç”¢å“ç¯©é¸å·¥å…·ï¼ˆæ–°å¢ï¼‰
```

#### 3. è³‡æ–™åº«æ¶æ§‹æ›´æ–°
```sql
-- æ–°å¢ï¼šåº«å­˜æ­·å²è¿½è¹¤è¡¨
CREATE TABLE inventory_history (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    platform TEXT NOT NULL,
    sku TEXT NOT NULL,
    quantity INTEGER NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- æ–°å¢ï¼šç”¢å“åŒæ­¥è¿½è¹¤è¡¨
CREATE TABLE product_sync_tracking (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    sync_date DATE NOT NULL,
    sync_type TEXT NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

#### 4. Google Sheets æ–°å¢å·¥ä½œè¡¨
- âœ… `Y&M_åº«å­˜æ¯”å°` - Yahoo vs MOMO å°ˆç”¨æ¯”å°è¡¨

#### 5. éæœŸç”¢å“ç¯©é¸æµç¨‹
```
åŸ·è¡Œ filter_expired_yahoo_products.py
    â†“
ç™»å…¥ Yahoo API
    â†“
ä¸‹è¼‰æ‰€æœ‰ç”¢å“ (22,050 å€‹)
    â†“
é€ä¸€æª¢æŸ¥ Listing endTs
    â†“
åˆ†é¡ï¼šå·²éæœŸ vs ä¸Šæ¶ä¸­
    â†“
è¼¸å‡º yahoo_expired_products.json
    â†“
ExpiredProductManager è¼‰å…¥ä½¿ç”¨
```

#### 6. åº«å­˜åŒæ­¥é‚è¼¯ï¼ˆç¸½é‡ç¢ºå®šè«–ï¼‰
```
è¦å‰‡ï¼š
- Y è³£å‡º -1 â†’ M ä¹Ÿ -1
- M è³£å‡º -1 â†’ Y ä¹Ÿ -1
- Y æ‰‹å‹• +1 â†’ M ä¹Ÿ +1
- M æ‰‹å‹• +1 â†’ Y ä¹Ÿ +1
- å·²éæœŸç”¢å“ â†’ ä¸åƒèˆ‡åŒæ­¥
```

### æŠ€è¡“å¯¦ä½œ

#### ExpiredProductManager
```python
class ExpiredProductManager:
    def __init__(self, json_path='yahoo_expired_products.json'):
        self.expired_products = set()  # 8,795 å€‹
        self.active_products = set()   # 13,255 å€‹
        
    def is_expired(self, part_no):
        """æª¢æŸ¥ç”¢å“æ˜¯å¦å·²éæœŸ"""
        return part_no in self.expired_products
```

#### Yahoo Client æ•´åˆ
```python
class YahooClient:
    def __init__(self, config):
        self.expired_manager = ExpiredProductManager()
        
    def get_inventory(self, filter_expired=True):
        """ç²å–åº«å­˜ï¼Œå¯é¸æ“‡éæ¿¾éæœŸç”¢å“"""
        products = self._fetch_all_products()
        
        if filter_expired:
            products = [
                p for p in products 
                if not self.expired_manager.is_expired(p['part_no'])
            ]
        
        return products
```

### æ•ˆèƒ½æ•¸æ“š
| é …ç›® | V4.5 | V5.0 | æ”¹å–„ |
|------|------|------|------|
| Yahoo ç”¢å“æ•¸ | 22,050 | 13,255 | -39.9% |
| åŒæ­¥æ™‚é–“ | 15 åˆ†é˜ | 10 åˆ†é˜ | -33% |
| è³‡æ–™æº–ç¢ºåº¦ | æœ‰é‡è¤‡ | ç„¡é‡è¤‡ | âœ… |
| API èª¿ç”¨æ¬¡æ•¸ | 22,050 | 13,255 | -39.9% |

### ä½¿ç”¨æ–¹å¼

#### æ¯æ—¥ä½¿ç”¨
```bash
# åŸ·è¡ŒåŒæ­¥ï¼ˆè‡ªå‹•éæ¿¾éæœŸç”¢å“ï¼‰
InventorySync_V5.exe
```

#### æ¯å‘¨ç¶­è­·
```bash
# é‡æ–°ç¯©é¸éæœŸç”¢å“ï¼ˆç´„ 5-6 å°æ™‚ï¼‰
python filter_expired_yahoo_products.py
```

### æª”æ¡ˆçµæ§‹
```
InventorySync_V5/
â”œâ”€â”€ InventorySync_V5.exe           # ä¸»ç¨‹å¼
â”œâ”€â”€ config/
â”‚   â””â”€â”€ credentials.json           # API è¨­å®š
â”œâ”€â”€ dashboard/
â”‚   â””â”€â”€ index.html                 # å„€è¡¨æ¿ç¶²é 
â”œâ”€â”€ yahoo_expired_products.json    # éæœŸç”¢å“åˆ—è¡¨
â”œâ”€â”€ inventory.db                   # æœ¬åœ°è³‡æ–™åº«
â”œâ”€â”€ sync_v5.log                    # åŸ·è¡Œæ—¥èªŒ
â”œâ”€â”€ README_V5.txt                  # ä½¿ç”¨èªªæ˜
â””â”€â”€ VERSION_V5.txt                 # ç‰ˆæœ¬è³‡è¨Š
```

### å·²çŸ¥é™åˆ¶
- âš ï¸ éæœŸç”¢å“ç¯©é¸éœ€ 5-6 å°æ™‚ï¼ˆæ¯å‘¨åŸ·è¡Œä¸€æ¬¡ï¼‰
- âš ï¸ éœ€åœ¨æœ‰ç™½åå–®çš„é›»è…¦ä¸ŠåŸ·è¡Œ
- âš ï¸ éæœŸç”¢å“åˆ—è¡¨éœ€æ‰‹å‹•æ›´æ–°

### æœªä¾†è¦åŠƒ
- ğŸ”® è‡ªå‹•åŒ–éæœŸç”¢å“ç¯©é¸
- ğŸ”® PChome/MOMO ä¸Šæ¶ç‹€æ…‹é‚è¼¯
- ğŸ”® å³æ™‚åº«å­˜ç›£æ§
- ğŸ”® æ•ˆèƒ½å„ªåŒ–ï¼ˆæ‰¹æ¬¡è™•ç†ï¼‰

---

## ğŸ“Š ç‰ˆæœ¬æ¯”è¼ƒè¡¨

| åŠŸèƒ½ | V1.0 | V2.0 | V3.0 | V4.0 | V4.2 | V4.3 | V4.5 | V5.0 |
|------|------|------|------|------|------|------|------|------|
| ä¸‰å¹³å°æ•´åˆ | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| é›¶åº«å­˜éæ¿¾ | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| å¤šå·¥ä½œè¡¨ | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… | âœ… |
| Yahoo Spec | âŒ | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… | âœ… |
| Spec ç°¡åŒ– | âŒ | âŒ | âŒ | âŒ | âœ… | âœ… | âœ… | âœ… |
| ç„¡å­—å…ƒé™åˆ¶ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… | âœ… | âœ… |
| éæœŸç”¢å“éæ¿¾ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… |
| Y&M æ¯”å°è¡¨ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… |
| åº«å­˜æ­·å²è¿½è¹¤ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âŒ | âœ… |

---

## ğŸ”§ æŠ€è¡“æ¼”é€²

### API æ•´åˆæ¼”é€²
```
V1.0: åŸºç¤ API èª¿ç”¨
  â†“
V2.0: åŠ å…¥è³‡æ–™éæ¿¾
  â†“
V4.0: æ•´åˆ Listing APIï¼ˆè¤‡é›œï¼‰
  â†“
V4.2: ç°¡åŒ–ç‚ºç”¢å“åç¨±è§£æ
  â†“
V5.0: åŠ å…¥éæœŸç”¢å“éæ¿¾
```

### è³‡æ–™åº«æ¼”é€²
```
V1.0: products + inventory + sync_history
  â†“
V5.0: + inventory_history + product_sync_tracking
```

### Google Sheets æ¼”é€²
```
V1.0: å–®ä¸€å·¥ä½œè¡¨
  â†“
V3.0: 5 å€‹å·¥ä½œè¡¨ï¼ˆå¹³å°åˆ†é›¢ï¼‰
  â†“
V5.0: 6 å€‹å·¥ä½œè¡¨ï¼ˆ+ Y&M æ¯”å°ï¼‰
```

---

## ğŸ“ é‡è¦æ–‡ä»¶

### æŠ€è¡“æ–‡ä»¶
- `README_V5.txt` - V5 ä½¿ç”¨èªªæ˜
- `YAHOO_éæœŸç”¢å“éæ¿¾èªªæ˜.md` - éæœŸç”¢å“éæ¿¾æŠ€è¡“æ–‡ä»¶
- `å°è©±è¨˜éŒ„_YahooéæœŸç”¢å“éæ¿¾_20251202.md` - é–‹ç™¼éç¨‹è¨˜éŒ„

### è¨­å®šæª”
- `config/credentials.json` - API æ†‘è­‰
- `config/credentials_template.json` - æ†‘è­‰ç¯„æœ¬

### è³‡æ–™æª”
- `yahoo_expired_products.json` - éæœŸç”¢å“åˆ—è¡¨
- `inventory.db` - æœ¬åœ°è³‡æ–™åº«

---

## ğŸ“ ç¶“é©—ç¸½çµ

### æˆåŠŸç¶“é©—
1. âœ… **æ¼¸é€²å¼é–‹ç™¼** - å¾ V1 åˆ° V5 é€æ­¥å„ªåŒ–
2. âœ… **å•é¡Œå°å‘** - æ¯å€‹ç‰ˆæœ¬è§£æ±ºç‰¹å®šå•é¡Œ
3. âœ… **å‘å¾Œç›¸å®¹** - V5 ä¿ç•™æ‰€æœ‰ V4 åŠŸèƒ½
4. âœ… **æ–‡ä»¶å®Œæ•´** - æ¯å€‹ç‰ˆæœ¬éƒ½æœ‰è©³ç´°è¨˜éŒ„

### å­¸åˆ°çš„æ•™è¨“
1. ğŸ“š **éåº¦è¤‡é›œåŒ–** - V4.0 çš„ Listing API æ•´åˆéæ–¼è¤‡é›œ
2. ğŸ“š **ç°¡åŒ–å„ªå…ˆ** - V4.2 è­‰æ˜ç°¡å–®æ–¹æ¡ˆæ›´å¥½
3. ğŸ“š **æ•ˆèƒ½è€ƒé‡** - API èª¿ç”¨æ¬¡æ•¸ç›´æ¥å½±éŸ¿é€Ÿåº¦
4. ğŸ“š **è³‡æ–™å“è³ª** - éæœŸç”¢å“éæ¿¾å¤§å¹…æå‡æº–ç¢ºåº¦

### æœªä¾†æ–¹å‘
1. ğŸš€ è‡ªå‹•åŒ–ç¨‹åº¦æå‡
2. ğŸš€ å³æ™‚ç›£æ§åŠŸèƒ½
3. ğŸš€ æ›´æ™ºèƒ½çš„åŒæ­¥é‚è¼¯
4. ğŸš€ æ›´å¥½çš„éŒ¯èª¤è™•ç†

---

**æ–‡ä»¶ç‰ˆæœ¬**: 1.0  
**æœ€å¾Œæ›´æ–°**: 2025-12-03  
**ç¶­è­·è€…**: Antigravity AI Assistant
